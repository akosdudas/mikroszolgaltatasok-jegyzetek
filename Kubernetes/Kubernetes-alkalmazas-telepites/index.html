
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Dudás Ákos">
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Alkalmazás telepítése Kubernetes klaszterbe - BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="red">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#alkalmazas-telepitese-kubernetes-klaszterbe" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés" class="md-header__button md-logo" aria-label="BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Alkalmazás telepítése Kubernetes klaszterbe
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/bmeviauav42/jegyzetek/" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauav42/jegyzetek
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Tárgy ismertető
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../hazi-feladat/" class="md-tabs__link">
      Házi feladat
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Docker/Docker-alapok/" class="md-tabs__link">
        Docker
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Architektura/AdatbazisApiGateway/" class="md-tabs__link">
        Architektúra
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../DevOps/Nyomkovetes/" class="md-tabs__link">
        DevOps
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Kubernetes-alapok/" class="md-tabs__link md-tabs__link--active">
        Kubernetes
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Serverless/serverless/" class="md-tabs__link">
        Serverless
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés" class="md-nav__button md-logo" aria-label="BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    BME AUT Mikroszolgáltatások és konténeralapú szoftverfejlesztés
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/bmeviauav42/jegyzetek/" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauav42/jegyzetek
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Tárgy ismertető
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../hazi-feladat/" class="md-nav__link">
        Házi feladat
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Docker
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Docker" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Docker-alapok/" class="md-nav__link">
        Docker alapok
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Dockerfile-compose/" class="md-nav__link">
        Dockerfile és docker-compose
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Architektúra
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Architektúra" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Architektúra
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Architektura/AdatbazisApiGateway/" class="md-nav__link">
        Adattárolás és Api Gateway
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Architektura/Kommunikacio/" class="md-nav__link">
        Kommunikáció
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        DevOps
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DevOps" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          DevOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/Nyomkovetes/" class="md-nav__link">
        Elosztott nyomkövetés
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/Logging-Health-Checks/" class="md-nav__link">
        Naplózás, health check
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/Prometheus-monitoring/" class="md-nav__link">
        Prometheus monitorozás Kubernetes-ben
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        Kubernetes
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Kubernetes-alapok/" class="md-nav__link">
        Kubernetes alapok
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Alkalmazás telepítése Kubernetes klaszterbe
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Alkalmazás telepítése Kubernetes klaszterbe
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cel" class="md-nav__link">
    Cél
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokovetelmenyek" class="md-nav__link">
    Előkövetelmények
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feladatok" class="md-nav__link">
    Feladatok
  </a>
  
    <nav class="md-nav" aria-label="Feladatok">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#celok-tervezes" class="md-nav__link">
    Célok, tervezés
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm" class="md-nav__link">
    Helm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-controller-api-gateway-telepitese-helm-charttal" class="md-nav__link">
    Ingress Controller (api gateway) telepítése Helm charttal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adatbazisok-telepitese" class="md-nav__link">
    Adatbázisok telepítése
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alkalmazasunk-telepitese" class="md-nav__link">
    Alkalmazásunk telepítése
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alkalmazas-frissitese" class="md-nav__link">
    Alkalmazás frissítése
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm-chart-keszitese" class="md-nav__link">
    Helm chart készítése
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../AKS/aks/" class="md-nav__link">
        K8S DevOps Azure DevOps-ban és Azure Kubernetes Service-szel
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Serverless
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Serverless" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Serverless
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Serverless/serverless/" class="md-nav__link">
        Mikroszolgáltatások serverless architektúra fölött
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cel" class="md-nav__link">
    Cél
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokovetelmenyek" class="md-nav__link">
    Előkövetelmények
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feladatok" class="md-nav__link">
    Feladatok
  </a>
  
    <nav class="md-nav" aria-label="Feladatok">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#celok-tervezes" class="md-nav__link">
    Célok, tervezés
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm" class="md-nav__link">
    Helm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-controller-api-gateway-telepitese-helm-charttal" class="md-nav__link">
    Ingress Controller (api gateway) telepítése Helm charttal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adatbazisok-telepitese" class="md-nav__link">
    Adatbázisok telepítése
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alkalmazasunk-telepitese" class="md-nav__link">
    Alkalmazásunk telepítése
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alkalmazas-frissitese" class="md-nav__link">
    Alkalmazás frissítése
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm-chart-keszitese" class="md-nav__link">
    Helm chart készítése
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/bmeviauav42/jegyzetek/edit/master/docs/Kubernetes/Kubernetes-alkalmazas-telepites.md" title="Oldal szerkesztése" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="alkalmazas-telepitese-kubernetes-klaszterbe">Alkalmazás telepítése Kubernetes klaszterbe<a class="headerlink" href="#alkalmazas-telepitese-kubernetes-klaszterbe" title="Permanent link">&para;</a></h1>
<h2 id="cel">Cél<a class="headerlink" href="#cel" title="Permanent link">&para;</a></h2>
<p>A labor célja egy alkalmazás telepítése Kubernetes klaszterbe, valamint a frissítés módjának megismerése. A telepítéshez és frissítéshez részben Helm chartot, részben magunk által elkészített yaml erőforrás leírókat használunk.</p>
<h2 id="elokovetelmenyek">Előkövetelmények<a class="headerlink" href="#elokovetelmenyek" title="Permanent link">&para;</a></h2>
<ul>
<li>Kubernetes<ul>
<li>Bármely felhő platform által biztosított klaszter</li>
<li>Linux platformon: <a href="https://kubernetes.io/docs/tasks/tools/install-minikube">minikube</a></li>
<li>Windows platformon: Docker Desktop</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a><ul>
<li>A binárisa legyen elérhető PATH-on.</li>
</ul>
</li>
<li><a href="https://helm.sh/docs/intro/install/">helm v3</a><ul>
<li>A binárisa legyen elérhető PATH-on.</li>
</ul>
</li>
<li>Kubernetes dashboard<ul>
<li>Telepítése és használata korábbi anyag szerint.</li>
</ul>
</li>
<li>Telepítendő alkalmazás<ul>
<li><a href="https://github.com/bmeviauav42/todoapp">https://github.com/bmeviauav42/todoapp</a></li>
<li><code>git clone https://github.com/bmeviauav42/todoapp.git</code></li>
</ul>
</li>
</ul>
<h2 id="feladatok">Feladatok<a class="headerlink" href="#feladatok" title="Permanent link">&para;</a></h2>
<h3 id="celok-tervezes">Célok, tervezés<a class="headerlink" href="#celok-tervezes" title="Permanent link">&para;</a></h3>
<p>A célunk a <a href="https://github.com/bmeviauav42/todoapp">todo-kat kezelő konténeralapú mikroszolgáltatásokra épülő webalkalmazás</a> telepítése Kubernetes-be. A rendszerünk alapvetően három féle komponensből épül fel:</p>
<ul>
<li>az általunk megvalósított mikroszolgáltatások (backend és frontend),</li>
<li>az adatbázis rendszerek (MongoDB, Elasticsearch és Redis),</li>
<li>valamint az api gateway.</li>
</ul>
<p>Célunk nem csak az egyszeri telepítés, hanem az alkalmazás naprakészen tartásához a folyamatos frissítés lehetőségének megteremtése. A fenti komponensek azonban nem ugyanolyan frissítési ciklussal rendelkeznek: a saját komponenseink gyakran fognak változni, míg az adatbázisok és az api gateway ritkán frissül. A telepítést ennek megfelelően ketté vágjuk:</p>
<ol>
<li>Az api gateway-t és az adatbázisokat egyszer telepítjük.</li>
<li>Az alkalmazásunk saját komponenseihez yaml alapú leírókat készítünk, amit <code>kubectl apply</code> segítségével fogunk telepíteni.</li>
</ol>
<h3 id="helm">Helm<a class="headerlink" href="#helm" title="Permanent link">&para;</a></h3>
<p>Ellenőrizzük, hogy a <code>helm</code> CLI elérhető-e: <code>helm version</code></p>
<div class="admonition note">
<p class="admonition-title">Helm 3</p>
<p>A feladat során a Helm 3-as verzióját fogjuk használni. A korábbi verziója koncepcióban azonos, de működésében eltérő.</p>
</div>
<h3 id="ingress-controller-api-gateway-telepitese-helm-charttal">Ingress Controller (api gateway) telepítése Helm charttal<a class="headerlink" href="#ingress-controller-api-gateway-telepitese-helm-charttal" title="Permanent link">&para;</a></h3>
<p>A Traefik-et <a href="https://github.com/containous/traefik-helm-chart">Helm charttal</a> fogjuk telepíteni, mert a Traefik helyes működéséhez a Traefik konténer (Deployment) mellett egyéb elemekre is szükség lesz (klaszteren belüli hozzáférés szabályzás miatt).</p>
<div class="admonition warning">
<p class="admonition-title">Chart-ok ellenőrzése</p>
<p>A Helm chartok nagy része harmadik féltől származik, így a klaszterünbe való telepítés előtt a tartalmukat érdemes alaposan megnézni.</p>
</div>
<ol>
<li>
<p>A Helm is repository-kkal dolgozik, ahonnan a chart-okat letölti. Ezeket regisztrálni kell. Regisztráljuk a Traefik hivatalos chart-ját tartalmazó repository-t, majd frissítsük az elérhető char-okat:</p>
<div class="highlight"><pre><span></span><code>helm repo add traefik https://containous.github.io/traefik-helm-chart
helm repo update
</code></pre></div>
</li>
<li>
<p>Telepítsük: <code>helm install traefik traefik/traefik --set ports.web.nodePort=32080 --set service.type=NodePort</code></p>
<ul>
<li>A legelső <code>traefik</code> a Helm release nevét adja meg. Ezzel tudunk rá hivatkozni a jövőben.</li>
<li>A <code>traefik/traefik</code> azonosítha a telepítendő chartot (repository/chartnév).</li>
<li>A <code>--set</code> kapcsolóval a chart változóit állítjuk be.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Publikus eléréshez</p>
<p>A Traefik jelen konfigurációban <em>NodePort</em> service típussal van konfigurálva, ami azt jelenti, lokálisan, helyben a megadott porton lesz csak elérhető. Ha publikusan elérhető klaszterben dolgozunk, akkor tipikusan <em>LoadBalancer</em> service típust fogunk kérni, hogy publikus IP címet is kapjon a Traefik.</p>
</div>
</li>
<li>
<p>Ellenőrizzük, hogy fut-e: <code>kubectl get pod</code></p>
<ul>
<li>Látunk kell egy traefik kezdetű podot.</li>
</ul>
</li>
<li>
<p>A Traefik dashboard-ja nem elérhető "kívülről". A dashboard segít minket látni a Traefik konfigurációját és működését. Mivel ez a klaszter belső állapotát publikálja, production üzemben valamilyen módon authentikálnunk kellene. Ezt most megkerülve <code>kubect</code> segítségével egy helyi portra továbbítjuk a Traefik dashboard-ot. A következő parancsot egy <strong>új</strong> konzolban adjuk ki, és utána hagyjuk nyitva a konzolt:</p>
<div class="highlight"><pre><span></span><code>kubectl port-forward <span class="k">$(</span>kubectl get pods --selector <span class="s2">&quot;app.kubernetes.io/name=traefik&quot;</span> --output<span class="o">=</span>name<span class="k">)</span> <span class="m">9000</span>:9000
</code></pre></div>
</li>
<li>
<p>Nézzük meg a Traefik dashboardot: <a href="http://localhost:9000/dashboard/">http://localhost:9000/dashboard/</a> (a végén kell a perjel!)</p>
</li>
</ol>
<div class="admonition note">
<p>Ha frissíteni szeretnénk később a Traefik-et, akkor azt a <code>helm upgrade traefik traefik/traefik ...</code> paranccsal tudjuk megtenni.</p>
</div>
<h3 id="adatbazisok-telepitese">Adatbázisok telepítése<a class="headerlink" href="#adatbazisok-telepitese" title="Permanent link">&para;</a></h3>
<p>Az adatbázisainkat saját magunk által megírt yaml leíróval telepítjük. Ez a leíró fájl már rendelkezésünkre áll a todoapp alkalmazás repositoryjában.</p>
<ol>
<li>Navigáljunk el a forráskód repository-jában a <em>kubernetes/db</em> könyvtárba. Nézzük meg a yaml leírókat.</li>
<li>Telepítsük az adatbázisokat: <code>kubectl apply -f db</code></li>
<li>Kapcsolódjunk a Kubernetes Dashboard-hoz a korábban ismertetett módon (ill. telepítsük a klaszterbe, ha nem lenne).</li>
<li>Ellenőrizzük, hogy az adatbázis podok elindulnak-e. Minden a <em>default</em> névtérbe kellett települjön.</li>
<li>Nézzük meg a <em>Persistent Volume</em> és <em>Persistent Volumen Claim</em>-eket.</li>
</ol>
<h3 id="alkalmazasunk-telepitese">Alkalmazásunk telepítése<a class="headerlink" href="#alkalmazasunk-telepitese" title="Permanent link">&para;</a></h3>
<p>Az alkalmazásunk telepítéséhez szintén yaml leírókat találunk a <em>kubernetes/app</em> könyvtárban.</p>
<ol>
<li>
<p>Nézzük meg a leírókat. Az előbb látott Deployment és Service mellet Ingress-t is látni fogunk.</p>
</li>
<li>
<p>Telepítsük az adatbázisokat: <code>kubectl apply -f app</code></p>
</li>
<li>
<p>Kubernetes dashboard segítségével nézzük meg, hogy létrejöttek a Deployment-ek podok, stb. Viszont vegyük észre, hogy piros lesz még pár dolog. A hiba oka, hogy a hivatkozott image-eket nem találja a rendszer.</p>
</li>
<li>
<p>Navigáljunk el az <code>src/Docker</code> könyvtárba, és buildeljük le az alkalmazást docker-compose segítségével úgy, hogy a megfelelő taggel ellátjuk az image-eket. Ehhez a compose fájlunk az <code>IMAGE_TAG</code> környezeti változó beállítását várja.</p>
<ul>
<li>
<p>Powershell-ben</p>
<div class="highlight"><pre><span></span><code><span class="nv">$env:IMAGE_TAG</span><span class="p">=</span><span class="s2">&quot;v1&quot;</span>
<span class="n">docker-compose</span> <span class="n">build</span>
</code></pre></div>
</li>
<li>
<p>Windows Command Prompt-ban</p>
<div class="highlight"><pre><span></span><code>setx IMAGE_TAG &quot;v1&quot;
docker-compose build
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>A build folyamat végén előállnak helyben az image-ek, pl. <code>todoapp/web:v1</code> taggel. Ha távoli registry-be szeretnénk feltölteni őket, akkor taggelhetnénk őket a registry-nek megfelelően. A helyi fejlesztéshez nincs szükségünk ehhez, mert a helyben elindított Kubernetes "látja" a Docker helyi image-eit.</p>
</li>
<li>
<p>Menjünk vissza a Kubernetes dashboard-ra. Egy kicsit várjunk, és azt kell lássuk, hogy az eddig piros elemek kizöldülnek. A Kubernetes folyamatosan törekszik az elvárt állapot elérésére, ezért a nem elérhető image-einket újra és újra megpróbálta elérni, míg nem sikerült.</p>
</li>
<li>
<p>Próbáljuk ki az alkalmazást a <a href="http://localhost:32080">http://localhost:32080</a> címen</p>
</li>
</ol>
<h3 id="alkalmazas-frissitese">Alkalmazás frissítése<a class="headerlink" href="#alkalmazas-frissitese" title="Permanent link">&para;</a></h3>
<p>Tegyük fel, hogy az alkalmazásunkból újabb verzió készül, és szeretnénk frissíteni. A fentebb használt yaml leírókat azért (is) a verziókezelőben tároljuk, mert így a telepítési "útmutatók" is verziózottak. Tehát nincs más dolgunk, mit a konténer image-ek elkészítése után a Deployment-ekben a megfelelő tag-ek lecserélése, és a <code>kubectl apply</code> paranccsal a telepítés frissítése.</p>
<h3 id="helm-chart-keszitese">Helm chart készítése<a class="headerlink" href="#helm-chart-keszitese" title="Permanent link">&para;</a></h3>
<p>Az alkalmazás fent ismertetett frissítéséhez a yaml fájlokba minden alkalommal bele kell írnunk. Jó lenne, ha az image tag-et mint egy változó tudnánk atelepítés során átadni. Erre szolgál a Helm. Készítsünk egy <em>chart</em>-ot a szolgáltatásainknak. A <em>chart</em> a telepítés leíró neve, ami gyakorlatilag yaml fájlok gyűjteménye egy speciális szintaktikával kiegészítva.</p>
<ol>
<li>
<p>Konzolban navigáljunk egy el tetszőleges munkakönyvtárba.</p>
</li>
<li>
<p>Készítsünk egy új, üres chart-ot: <code>helm create todoapp</code>. Ez létrehoz egy <em>todoapp</em> nevű chartot egy azonos nevű könyvtárban.</p>
</li>
<li>
<p>Nézzük meg a chart fájljait.</p>
<ul>
<li><code>Chart.yaml</code> a metaadatokat írja le.</li>
<li><code>values.yaml</code> írja le a változóink alapértelmezett értékeit.</li>
<li><code>.helmignore</code> azon fájlokat listázza, amelyeket a chart értelmezésekor nem kell figyelembe venni.</li>
<li><code>templates</code> könyvtárban vannak a template fájlok, amik a generálás alapjául szolgálnak.</li>
</ul>
<p>A Helm egy olyan template nyelvet használ, amelyben változó behelyettesítések, ciklusok, egyszerű szövegműveletek támogatottak. Mi most csak a változó behelyettesítést fogjuk használni.</p>
</li>
<li>
<p>Töröljük ki a <code>templates</code> könyvtárból az összes fájlt a <code>_helpers.tpl</code> kivételével. Másoljuk helyette be ide a korábban a telepítéshez használt yaml fájljainkat (3 darab).</p>
</li>
<li>
<p>Szerkesszük meg a <code>todos.yaml</code> fájl tartalmát. Leegyszerűsítve az alábbiakra lesz szükség:</p>
<ul>
<li>
<p>Ha <em>Visual Studio Code</em>-ot használunk, akkor telepítsük a <a href="https://marketplace.visualstudio.com/items?itemName=ms-kubernetes-tools.vscode-kubernetes-tools"><code>ms-kubernetes-tools.vscode-kubernetes-tools</code></a> extension-t. Így kapunk némi segítséget a szintaktikával.</p>
</li>
<li>
<p>Mindenhol, ahol <em>labels</em> vagy <em>matchLabels</em> szerepel, még egy sort fel kell vennünk:</p>
<p><code>app.kubernetes.io/instance: {{ .Release.Name }}</code></p>
<p>Ez egy implicit változót helyettesít be: a <em>release</em> nevét. Ezzel azonosítja a Helm a telepítés és frissítés során, hogy mely elemeket kell frissítenie, melyek tartoznak a fennhatósága alá.</p>
</li>
<li>
<p>A pod-ban az image beállításához használjunk változót:</p>
<p><code>image: todoapp/todos: {{ .Values.todos.tag }}</code></p>
</li>
</ul>
</li>
<li>
<p>Definiáljuk az előbbi változó alapértelmezett értékét. A <code>values.yaml</code> fájlban (egy könyvtárral feljebb) töröljünk ki mindent, és vegyük fel ezt a kulcsot:</p>
<div class="highlight"><pre><span></span><code><span class="nt">todos</span><span class="p">:</span>
  <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
</code></pre></div>
</li>
<li>
<p>A másik két komponens yaml leíróival is hasonlóan kell eljárnunk.</p>
</li>
<li>
<p>A továbbiakhoz el kell távolítanunk az előbb telepített alkalmazásunkat, mert összeakadna a Helm-mel. Ezt a parancsot a telepítéshez korábban használt <code>app</code> könyvtárban adjuk ki: <code>kubectl delete -f app</code></p>
</li>
<li>
<p>Nézzük meg a template-eket kiértékelve.</p>
<ul>
<li>A chartunk könyvtárából lépjünk eggyel feljebb, hogy a <code>todoapp</code> chart könyvtár az aktuális könyvtárban legyen.</li>
<li>Futtassuk le csak a template generálást a telepítés nélkül: <code>helm install todoapp --debug --dry-run todoapp</code></li>
<li>Konzolra megkapjuk a kiértékelt yaml-öket.</li>
</ul>
</li>
<li>
<p>Telepítsük újra az alkalmazást a chart segítségével: <code>helm upgrade todoapp --install todoapp</code></p>
<ul>
<li>
<p>A release-nek <em>todoapp</em> nevet választottunk. Ez a Helm release azonosítója.</p>
</li>
<li>
<p>Az <em>upgrade</em> parancs és az <em>--install</em> kapcsoló telepít, ha nem létezik, ill. frissít, ha már létezik ilyen telepítés.</p>
</li>
</ul>
</li>
<li>
<p>Nézzük meg, hogy a Helm szerint létezik-e a release: <code>helm list</code></p>
</li>
<li>
<p>Próbáljuk ki az alkalmazást a <a href="http://localhost:32080">http://localhost:32080</a> címen.</p>
</li>
<li>
<p>Ezen chart segítségével a Docker image tag-et telepítési paraméterben adhatjuk át, pl. ha a "v2" az új tag, akkor egy paranccsal tudjuk frissíteni: <code>helm upgrade todoapp --install todoapp --set todos.tag=v2</code></p>
</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    <nav
      class="md-footer__inner md-grid"
      aria-label="Footer"
    >

      <!-- Link to previous page -->
      
        <a
          href="../Kubernetes-alapok/"
          class="md-footer__link md-footer__link--prev"
          rel="prev"
        >
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Előző
              </span>
              Kubernetes alapok
            </div>
          </div>
        </a>
      

      <!-- Link to next page -->
      
        <a
          href="../../AKS/aks/"
          class="md-footer__link md-footer__link--next"
          rel="next"
        >
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Következő
              </span>
              K8S DevOps Azure DevOps-ban és Azure Kubernetes Service-szel
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">

      <!-- Copyright and theme information -->
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; BME VIK AUT
          </div>
        
      </div>

      <!-- Social links -->
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "search.config.lang": "hu", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Keres\u00e9s", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>